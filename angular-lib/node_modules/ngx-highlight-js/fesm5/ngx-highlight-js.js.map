{"version":3,"file":"ngx-highlight-js.js","sources":["ng://ngx-highlight-js/src/highlight-js.directive.ts","ng://ngx-highlight-js/src/highlight-js.module.ts","ng://ngx-highlight-js/ngx-highlight-js.ts"],"sourcesContent":["import {\r\n  Directive,\r\n  ElementRef,\r\n  Input,\r\n  OnInit,\r\n  OnDestroy,\r\n  AfterViewInit,\r\n  Inject,\r\n  Optional,\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { NgModel } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\n\r\ndeclare const hljs: any;\r\n\r\n@Directive({\r\n  selector: '[highlight-js]',\r\n  host: {\r\n    style: 'display:none;',\r\n  },\r\n  exportAs: 'highlightJs',\r\n})\r\nexport class HighlightJsDirective implements OnInit, AfterViewInit, OnDestroy {\r\n  @Input() options: any;\r\n  @Input() lang = 'html';\r\n  @Input() code: string;\r\n\r\n  protected codeEl: HTMLElement;\r\n  protected parentEl: HTMLElement;\r\n  private modelValue$: Subscription;\r\n\r\n  constructor(\r\n    private el: ElementRef<HTMLElement>,\r\n    @Optional() private ngModel: NgModel,\r\n    @Inject(DOCUMENT) private doc: any,\r\n  ) {}\r\n\r\n  private escapeHTML(str: string): string {\r\n    return (str || '')\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&apos;');\r\n  }\r\n\r\n  private init() {\r\n    this.destroy();\r\n    this.codeEl = this.doc.createElement('pre');\r\n    if (this.lang) {\r\n      this.codeEl.className = this.lang;\r\n    }\r\n    this.codeEl.innerHTML =\r\n      this.code || '' + this.el.nativeElement.innerHTML.trim();\r\n    this.parentEl = this.el.nativeElement.parentNode as HTMLElement;\r\n    this.parentEl.insertBefore(this.codeEl, this.el.nativeElement.nextSibling);\r\n\r\n    hljs.configure(Object.assign({}, this.options));\r\n    hljs.highlightBlock(this.codeEl);\r\n  }\r\n\r\n  private destroy() {\r\n    if (this.codeEl) {\r\n      this.parentEl.removeChild(this.codeEl);\r\n      this.codeEl = null;\r\n    }\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.init();\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    if (this.ngModel) {\r\n      this.modelValue$ = this.ngModel.valueChanges.subscribe(res => {\r\n        this.code = this.escapeHTML(res);\r\n        this.init();\r\n      });\r\n    } else {\r\n      this.initMutation();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy();\r\n    this.destroyMutation();\r\n    if (this.modelValue$) {\r\n      this.modelValue$.unsubscribe();\r\n    }\r\n  }\r\n\r\n  // #region Mutation\r\n\r\n  private observer: MutationObserver;\r\n  private initMutation() {\r\n    if (typeof MutationObserver === 'undefined') return;\r\n    this.observer = new MutationObserver(this.init.bind(this));\r\n    this.observer.observe(this.el.nativeElement, {\r\n      characterData: true,\r\n      childList: true,\r\n      subtree: true,\r\n    });\r\n  }\r\n\r\n  private destroyMutation() {\r\n    if (!this.observer) return;\r\n    this.observer.disconnect();\r\n  }\r\n\r\n  // #endregionn\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HighlightJsDirective } from './highlight-js.directive';\r\n\r\n@NgModule({\r\n  imports: [FormsModule],\r\n  declarations: [HighlightJsDirective],\r\n  exports: [HighlightJsDirective]\r\n})\r\nexport class HighlightJsModule {\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}